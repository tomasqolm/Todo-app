<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Moje Ãºlohy</title>
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="shortcut icon" href="/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Ãšlohy">
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    function TodoApp() {
      const [showStats, setShowStats] = useState(false);
      const [showExpandedStats, setShowExpandedStats] = useState(false);
      const [showCalendar, setShowCalendar] = useState(false);
      const [showPizzaReview, setShowPizzaReview] = useState(false);
      const [showCompleted, setShowCompleted] = useState(false);
      const [showInbox, setShowInbox] = useState(true);
      const [showToday, setShowToday] = useState(true);
      const [showThisWeek, setShowThisWeek] = useState(true);
      const [showNextWeek, setShowNextWeek] = useState(true);
      const [showLater, setShowLater] = useState(true);
      const [showSomeday, setShowSomeday] = useState(true);
      const [pizzaReviewDate, setPizzaReviewDate] = useState(null);
      const [editingPizzaDate, setEditingPizzaDate] = useState(false);
      const [currentMonth, setCurrentMonth] = useState(new Date());
      const [selectedDate, setSelectedDate] = useState(null);
      const [todos, setTodos] = useState([]);
      const [isSaving, setIsSaving] = useState(false);
      const [newTask, setNewTask] = useState('');
      const [newDate, setNewDate] = useState('');
      const [newDateType, setNewDateType] = useState('');
      const [newPriority, setNewPriority] = useState('less-urgent');
      const [newStatus, setNewStatus] = useState('none');
      const [editingId, setEditingId] = useState(null);
      const [editingFullMode, setEditingFullMode] = useState(false);
      const [showDatePicker, setShowDatePicker] = useState(null);
      const [editTask, setEditTask] = useState('');
      const [editDate, setEditDate] = useState('');
      const [editDateType, setEditDateType] = useState('inbox');
      const [editPriority, setEditPriority] = useState('less-urgent');
      const [editStatus, setEditStatus] = useState('none');
      const [isTyping, setIsTyping] = useState(false);

      useEffect(() => {
        loadTodos();
        
        // Periodic sync every 30 seconds
        const syncInterval = setInterval(() => {
          console.log('ğŸ”„ Auto-sync...');
          loadTodos();
        }, 30000);
        
        return () => clearInterval(syncInterval);
      }, []);

      useEffect(() => {
        if (todos.length > 0) {
          const timeoutId = setTimeout(() => {
            saveTodos();
          }, 1000);
          
          return () => clearTimeout(timeoutId);
        }
      }, [todos]);

      useEffect(() => {
        if (pizzaReviewDate !== null) {
          saveTodos();
        }
      }, [pizzaReviewDate]);

      const loadTodos = async () => {
        try {
          const response = await fetch('/api/todos');
          if (response.ok) {
            const data = await response.json();
            const serverTodos = data.todos || data;
            
            // Migrate server todos
            const migratedServerTodos = Array.isArray(serverTodos) ? serverTodos.map(todo => ({
              ...todo,
              dateType: todo.dateType || 'specific',
              dateLabel: todo.dateLabel || null,
              completedAt: todo.completedAt || null,
              status: todo.status || 'none',
              lastModified: todo.lastModified || todo.id // Use creation time if no lastModified
            })) : [];
            
            // Get local todos (if any exist from previous session)
            const localTodos = todos;
            
            // Merge logic: combine server and local, keeping newest version of each task
            const mergedTodos = {};
            
            // Add all server todos
            migratedServerTodos.forEach(todo => {
              mergedTodos[todo.id] = todo;
            });
            
            // Add or update with local todos if they're newer
            localTodos.forEach(todo => {
              const todoWithModified = {
                ...todo,
                lastModified: todo.lastModified || todo.id
              };
              
              if (!mergedTodos[todo.id] || todoWithModified.lastModified > mergedTodos[todo.id].lastModified) {
                mergedTodos[todo.id] = todoWithModified;
              }
            });
            
            const finalTodos = Object.values(mergedTodos);
            setTodos(finalTodos);
            
            console.log('ğŸ“¥ Loaded todos:', {
              server: migratedServerTodos.length,
              local: localTodos.length,
              merged: finalTodos.length
            });
            
            // Load pizza review date
            if (data.pizzaReviewDate) {
              setPizzaReviewDate(data.pizzaReviewDate);
            }
          }
        } catch (error) {
          console.error('âŒ Failed to load todos:', error);
        }
      };

      const saveTodos = async () => {
        setIsSaving(true);
        try {
          // Add lastModified timestamp to all todos before saving
          const todosWithTimestamp = todos.map(todo => ({
            ...todo,
            lastModified: Date.now()
          }));
          
          const response = await fetch('/api/todos', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              todos: todosWithTimestamp,
              pizzaReviewDate: pizzaReviewDate
            })
          });
          
          if (response.ok) {
            console.log('ğŸ’¾ Saved todos:', todosWithTimestamp.length);
            // Update local state with timestamps
            setTodos(todosWithTimestamp);
          } else {
            console.error('âŒ Save failed:', response.status);
          }
        } catch (error) {
          console.error('âŒ Failed to save todos:', error);
        } finally {
          setIsSaving(false);
        }
      };

      const getStats = () => {
        const completed = todos.filter(t => t.completed);
        const now = new Date();
        
        const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        const completedToday = completed.filter(t => {
          if (!t.completedAt) return false;
          const completedDate = new Date(t.completedAt);
          return completedDate >= todayStart;
        }).length;
        
        const weekAgo = new Date(now);
        weekAgo.setDate(now.getDate() - 7);
        const completedThisWeek = completed.filter(t => {
          if (!t.completedAt) return false;
          const completedDate = new Date(t.completedAt);
          return completedDate >= weekAgo;
        }).length;
        
        const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);
        const completedThisMonth = completed.filter(t => {
          if (!t.completedAt) return false;
          const completedDate = new Date(t.completedAt);
          return completedDate >= monthStart;
        }).length;
        
        return {
          today: completedToday,
          week: completedThisWeek,
          month: completedThisMonth,
          total: completed.length
        };
      };

      const getAdvancedStats = () => {
        const completed = todos.filter(t => t.completed && t.completedAt);
        const now = new Date();
        
        // Most productive hour
        const hourCounts = {};
        completed.forEach(t => {
          const hour = new Date(t.completedAt).getHours();
          hourCounts[hour] = (hourCounts[hour] || 0) + 1;
        });
        const mostProductiveHour = Object.keys(hourCounts).length > 0 
          ? Object.entries(hourCounts).sort((a, b) => b[1] - a[1])[0]
          : null;
        
        // Most productive day of week
        const dayNames = ['NedeÄ¾a', 'Pondelok', 'Utorok', 'Streda', 'Å tvrtok', 'Piatok', 'Sobota'];
        const dayCounts = {};
        completed.forEach(t => {
          const day = new Date(t.completedAt).getDay();
          dayCounts[day] = (dayCounts[day] || 0) + 1;
        });
        const mostProductiveDay = Object.keys(dayCounts).length > 0
          ? Object.entries(dayCounts).sort((a, b) => b[1] - a[1])[0]
          : null;
        
        // Morning vs Evening person
        let morning = 0, afternoon = 0, evening = 0;
        completed.forEach(t => {
          const hour = new Date(t.completedAt).getHours();
          if (hour >= 6 && hour < 12) morning++;
          else if (hour >= 12 && hour < 18) afternoon++;
          else evening++;
        });
        const totalTimeSlots = morning + afternoon + evening;
        const timePreference = morning > afternoon && morning > evening ? 'RÃ¡no' 
          : afternoon > evening ? 'PopoludnÃ­' 
          : 'VeÄer';
        
        // Current streak
        let currentStreak = 0;
        let longestStreak = 0;
        let tempStreak = 0;
        const dateMap = {};
        
        completed.forEach(t => {
          const date = new Date(t.completedAt).toISOString().split('T')[0];
          dateMap[date] = true;
        });
        
        // Calculate current streak
        const today = new Date();
        let checkDate = new Date(today);
        while (true) {
          const dateStr = checkDate.toISOString().split('T')[0];
          if (dateMap[dateStr]) {
            currentStreak++;
            checkDate.setDate(checkDate.getDate() - 1);
          } else {
            break;
          }
        }
        
        // Calculate longest streak
        const sortedDates = Object.keys(dateMap).sort();
        for (let i = 0; i < sortedDates.length; i++) {
          if (i === 0 || new Date(sortedDates[i]) - new Date(sortedDates[i-1]) === 86400000) {
            tempStreak++;
            longestStreak = Math.max(longestStreak, tempStreak);
          } else {
            tempStreak = 1;
          }
        }
        
        // Priority distribution
        const priorityCounts = { urgent: 0, 'less-urgent': 0, 'can-wait': 0 };
        completed.forEach(t => {
          if (t.priority) priorityCounts[t.priority] = (priorityCounts[t.priority] || 0) + 1;
        });
        
        // Average time to completion by priority
        const priorityTimes = { urgent: [], 'less-urgent': [], 'can-wait': [] };
        completed.forEach(t => {
          if (t.completedAt && t.id) {
            const created = new Date(t.id); // ID is timestamp
            const completedDate = new Date(t.completedAt);
            const days = (completedDate - created) / (1000 * 60 * 60 * 24);
            if (t.priority && days >= 0) {
              priorityTimes[t.priority].push(days);
            }
          }
        });
        
        const avgTimes = {};
        Object.keys(priorityTimes).forEach(priority => {
          if (priorityTimes[priority].length > 0) {
            const sum = priorityTimes[priority].reduce((a, b) => a + b, 0);
            avgTimes[priority] = (sum / priorityTimes[priority].length).toFixed(1);
          }
        });
        
        // Last 30 days bar chart data
        const last30Days = [];
        for (let i = 29; i >= 0; i--) {
          const date = new Date(now);
          date.setDate(date.getDate() - i);
          const dateStr = date.toISOString().split('T')[0];
          const count = completed.filter(t => {
            return new Date(t.completedAt).toISOString().split('T')[0] === dateStr;
          }).length;
          last30Days.push({ date: dateStr, count });
        }
        
        // Personal best (most tasks in one day)
        const dailyCounts = {};
        completed.forEach(t => {
          const date = new Date(t.completedAt).toISOString().split('T')[0];
          dailyCounts[date] = (dailyCounts[date] || 0) + 1;
        });
        const personalBest = Object.keys(dailyCounts).length > 0
          ? Math.max(...Object.values(dailyCounts))
          : 0;
        
        // Average per day (last 30 days)
        const thirtyDaysAgo = new Date(now);
        thirtyDaysAgo.setDate(now.getDate() - 30);
        const last30DaysCompleted = completed.filter(t => {
          return new Date(t.completedAt) >= thirtyDaysAgo;
        }).length;
        const avgPerDay = (last30DaysCompleted / 30).toFixed(1);
        
        // Trend (this week vs last week)
        const lastWeekStart = new Date(now);
        lastWeekStart.setDate(now.getDate() - 14);
        const lastWeekEnd = new Date(now);
        lastWeekEnd.setDate(now.getDate() - 7);
        
        const thisWeekCount = completed.filter(t => {
          const date = new Date(t.completedAt);
          return date >= lastWeekEnd;
        }).length;
        
        const prevWeekCount = completed.filter(t => {
          const date = new Date(t.completedAt);
          return date >= lastWeekStart && date < lastWeekEnd;
        }).length;
        
        const trend = prevWeekCount > 0 
          ? (((thisWeekCount - prevWeekCount) / prevWeekCount) * 100).toFixed(0)
          : thisWeekCount > 0 ? 100 : 0;
        
        // Most productive month
        const monthCounts = {};
        completed.forEach(t => {
          const date = new Date(t.completedAt);
          const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
          monthCounts[monthKey] = (monthCounts[monthKey] || 0) + 1;
        });
        const mostProductiveMonth = Object.keys(monthCounts).length > 0
          ? Object.entries(monthCounts).sort((a, b) => b[1] - a[1])[0]
          : null;
        
        return {
          mostProductiveHour: mostProductiveHour ? `${mostProductiveHour[0]}:00 (${mostProductiveHour[1]} Ãºloh)` : 'N/A',
          mostProductiveDay: mostProductiveDay ? `${dayNames[mostProductiveDay[0]]} (${mostProductiveDay[1]} Ãºloh)` : 'N/A',
          timePreference: `${timePreference} (${totalTimeSlots > 0 ? Math.round((timePreference === 'RÃ¡no' ? morning : timePreference === 'PopoludnÃ­' ? afternoon : evening) / totalTimeSlots * 100) : 0}%)`,
          currentStreak,
          longestStreak,
          priorityCounts,
          avgTimes,
          last30Days,
          personalBest,
          avgPerDay,
          trend,
          trendDirection: trend > 0 ? 'up' : trend < 0 ? 'down' : 'stable',
          mostProductiveMonth: mostProductiveMonth ? `${mostProductiveMonth[0]} (${mostProductiveMonth[1]} Ãºloh)` : 'N/A',
          totalCompleted: completed.length,
          thisWeekCount,
          prevWeekCount
        };
      };

      const addTodo = () => {
        if (!newTask.trim()) return;
        
        let finalDate;
        let dateLabel;
        let finalDateType = newDateType || 'inbox'; // Default to inbox if nothing selected
        
        switch(finalDateType) {
          case 'inbox':
            finalDate = 'inbox';
            dateLabel = 'Inbox';
            break;
          case 'today':
            finalDate = new Date().toISOString().split('T')[0];
            dateLabel = 'Dnes';
            break;
          case 'week':
            finalDate = 'this-week';
            dateLabel = 'Tento tÃ½Å¾deÅˆ';
            break;
          case 'someday':
            finalDate = 'someday';
            dateLabel = 'Niekedy';
            break;
          case 'specific':
          default:
            finalDate = newDate || new Date().toISOString().split('T')[0];
            dateLabel = null;
            break;
        }
        
        const now = Date.now();
        const todo = {
          id: now,
          task: newTask,
          date: finalDate,
          dateLabel: dateLabel,
          dateType: finalDateType,
          priority: newPriority,
          status: newStatus,
          completed: false,
          completedAt: null,
          order: todos.length,
          lastModified: now
        };
        
        console.log('â• Adding todo:', todo.task);
        setTodos([...todos, todo]);
        setNewTask('');
        setNewDate('');
        setNewDateType('');
        setNewPriority('less-urgent');
        setNewStatus('none');
      };

      const startEdit = (todo) => {
        setEditingId(todo.id);
        setEditTask(todo.task);
      };

      const startFullEdit = (todo) => {
        setEditingId(todo.id);
        setEditingFullMode(true);
        setEditTask(todo.task);
        setEditDate(todo.dateType === 'specific' || !todo.dateType ? todo.date : '');
        setEditDateType(todo.dateType || 'inbox');
        setEditPriority(todo.priority || 'less-urgent');
        setEditStatus(todo.status || 'none');
      };

      const saveFullEdit = () => {
        if (!editTask.trim()) return;
        
        let finalDate;
        let dateLabel;
        
        switch(editDateType) {
          case 'inbox':
            finalDate = 'inbox';
            dateLabel = 'Inbox';
            break;
          case 'today':
            finalDate = new Date().toISOString().split('T')[0];
            dateLabel = 'Dnes';
            break;
          case 'week':
            finalDate = 'this-week';
            dateLabel = 'Tento tÃ½Å¾deÅˆ';
            break;
          case 'someday':
            finalDate = 'someday';
            dateLabel = 'Niekedy';
            break;
          case 'specific':
          default:
            finalDate = editDate;
            dateLabel = null;
            break;
        }
        
        setTodos(todos.map(t => 
          t.id === editingId 
            ? { ...t, task: editTask, date: finalDate, dateLabel: dateLabel, dateType: editDateType, priority: editPriority, status: editStatus, lastModified: Date.now() }
            : t
        ));
        cancelEdit();
      };

      const cancelEdit = () => {
        setEditingId(null);
        setEditingFullMode(false);
        setEditTask('');
        setEditDate('');
        setEditDateType('inbox');
        setEditPriority('less-urgent');
        setEditStatus('none');
      };

      const saveTaskName = (id, newTaskName) => {
        if (!newTaskName.trim()) return;
        setTodos(todos.map(t => 
          t.id === id ? { ...t, task: newTaskName, lastModified: Date.now() } : t
        ));
        setEditingId(null);
      };

      const quickChangeDateSpecific = (id, date) => {
        setTodos(todos.map(t => 
          t.id === id ? { ...t, date: date, dateLabel: null, dateType: 'specific', lastModified: Date.now() } : t
        ));
        setShowDatePicker(null);
      };

      const quickChangeDate = (id, dateType) => {
        let finalDate;
        let dateLabel;
        
        switch(dateType) {
          case 'inbox':
            finalDate = 'inbox';
            dateLabel = 'Inbox';
            break;
          case 'today':
            finalDate = new Date().toISOString().split('T')[0];
            dateLabel = 'Dnes';
            break;
          case 'week':
            finalDate = 'this-week';
            dateLabel = 'Tento tÃ½Å¾deÅˆ';
            break;
          case 'someday':
            finalDate = 'someday';
            dateLabel = 'Niekedy';
            break;
          default:
            return;
        }
        
        setTodos(todos.map(t => 
          t.id === id ? { ...t, date: finalDate, dateLabel: dateLabel, dateType: dateType, lastModified: Date.now() } : t
        ));
      };

      const changeStatus = (id, newStatus) => {
        setTodos(todos.map(t => 
          t.id === id ? { ...t, status: newStatus, lastModified: Date.now() } : t
        ));
      };

      const toggleComplete = (id) => {
        setTodos(todos.map(t => {
          if (t.id === id) {
            return {
              ...t,
              completed: !t.completed,
              completedAt: !t.completed ? new Date().toISOString() : null,
              lastModified: Date.now()
            };
          }
          return t;
        }));
      };

      const deleteTodo = (id) => {
        console.log('ğŸ—‘ï¸ Deleting todo:', id);
        setTodos(todos.filter(t => t.id !== id));
      };

      const changePriority = (id, newPriority) => {
        setTodos(todos.map(t => 
          t.id === id ? { ...t, priority: newPriority, lastModified: Date.now() } : t
        ));
      };

      const isThisWeek = (dateStr) => {
        if (dateStr === 'this-week') return true;
        if (dateStr === 'someday' || dateStr === 'inbox') return false;
        
        const date = new Date(dateStr);
        const today = new Date();
        
        const currentDay = today.getDay();
        const mondayOffset = currentDay === 0 ? -6 : 1 - currentDay;
        
        const thisMonday = new Date(today);
        thisMonday.setDate(today.getDate() + mondayOffset);
        thisMonday.setHours(0, 0, 0, 0);
        
        const thisSunday = new Date(thisMonday);
        thisSunday.setDate(thisMonday.getDate() + 6);
        thisSunday.setHours(23, 59, 59, 999);
        
        return date >= thisMonday && date <= thisSunday;
      };

      const isNextWeek = (dateStr) => {
        if (dateStr === 'someday' || dateStr === 'this-week' || dateStr === 'inbox') return false;
        
        const date = new Date(dateStr);
        const today = new Date();
        
        const currentDay = today.getDay();
        const mondayOffset = currentDay === 0 ? -6 : 1 - currentDay;
        
        const nextMonday = new Date(today);
        nextMonday.setDate(today.getDate() + mondayOffset + 7);
        nextMonday.setHours(0, 0, 0, 0);
        
        const nextSunday = new Date(nextMonday);
        nextSunday.setDate(nextMonday.getDate() + 6);
        nextSunday.setHours(23, 59, 59, 999);
        
        return date >= nextMonday && date <= nextSunday;
      };

      const isToday = (dateStr) => {
        if (dateStr === 'inbox') return false;
        const date = new Date(dateStr);
        const today = new Date();
        return date.toDateString() === today.toDateString();
      };

      const getTimelineGroups = () => {
        const groups = {
          inbox: [],
          today: [],
          thisWeek: [],
          nextWeek: [],
          later: [],
          someday: []
        };

        todos.filter(t => !t.completed).forEach(todo => {
          if (todo.date === 'inbox') {
            groups.inbox.push(todo);
          } else if (todo.date === 'someday') {
            groups.someday.push(todo);
          } else if (isToday(todo.date)) {
            groups.today.push(todo);
          } else if (isThisWeek(todo.date)) {
            groups.thisWeek.push(todo);
          } else if (isNextWeek(todo.date)) {
            groups.nextWeek.push(todo);
          } else {
            groups.later.push(todo);
          }
        });

        const priorityOrder = { high: 0, medium: 1, low: 2, 'less-urgent': 1, 'can-wait': 2, urgent: 0 };
        const sortByPriorityAndDate = (a, b) => {
          const dateA = new Date(a.date === 'this-week' || a.date === 'someday' || a.date === 'inbox' ? '2099-12-31' : a.date);
          const dateB = new Date(b.date === 'this-week' || b.date === 'someday' || b.date === 'inbox' ? '2099-12-31' : b.date);
          
          if (dateA.getTime() !== dateB.getTime()) {
            return dateA - dateB;
          }
          
          if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
            return priorityOrder[a.priority] - priorityOrder[b.priority];
          }
          
          return 0;
        };

        groups.inbox.sort(sortByPriorityAndDate);
        groups.today.sort(sortByPriorityAndDate);
        groups.thisWeek.sort(sortByPriorityAndDate);
        groups.nextWeek.sort(sortByPriorityAndDate);
        groups.later.sort(sortByPriorityAndDate);
        groups.someday.sort(sortByPriorityAndDate);

        return groups;
      };

      const displayTodos = getTimelineGroups();

      const formatDate = (dateStr, dateLabel) => {
        if (dateLabel) return dateLabel;
        
        if (dateStr === 'inbox') return 'Inbox';
        if (dateStr === 'this-week') return 'Tento tÃ½Å¾deÅˆ';
        if (dateStr === 'someday') return 'Niekedy';
        
        const date = new Date(dateStr);
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        if (date.toDateString() === today.toDateString()) return 'Dnes';
        if (date.toDateString() === tomorrow.toDateString()) return 'Zajtra';
        
        return date.toLocaleDateString('sk-SK', { day: 'numeric', month: 'short' });
      };

      const stats = getStats();
      const advancedStats = getAdvancedStats();

      const getDaysInMonth = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDayOfWeek = firstDay.getDay();
        
        return { daysInMonth, startingDayOfWeek, year, month };
      };

      const getTasksForDate = (dateStr) => {
        return todos.filter(t => {
          if (t.date === 'this-week' || t.date === 'someday' || t.date === 'inbox') return false;
          return t.date === dateStr;
        });
      };

      const previousMonth = () => {
        setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1));
      };

      const nextMonth = () => {
        setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1));
      };

      const TodoItem = ({ todo }) => (
        <div
          className={`group flex items-start gap-4 p-5 rounded-xl border transition-all duration-300 ${
            editingId === todo.id
              ? 'bg-white border-blue-400 shadow-xl scale-105'
              : todo.completed 
                ? 'bg-gray-50 border-gray-200 opacity-50' 
                : 'bg-white border-gray-200 hover:border-blue-300 hover:shadow-md cursor-pointer'
          }`}
          style={{
            borderColor: editingId === todo.id ? '#5176FB' : undefined
          }}
        >
          <button
            onClick={() => toggleComplete(todo.id)}
            className={`mt-1 w-7 h-7 rounded-lg border-2 flex items-center justify-center transition-all duration-300 flex-shrink-0 ${
              todo.completed 
                ? 'bg-green-500 border-green-500 shadow-md' 
                : 'border-gray-300 hover:border-blue-400 hover:bg-blue-50'
            }`}
          >
            {todo.completed && <span className="text-white text-lg">âœ“</span>}
          </button>
          
          {editingId === todo.id && editingFullMode ? (
            <div className="flex-1 space-y-3">
              <input
                type="text"
                value={editTask}
                onChange={(e) => setEditTask(e.target.value)}
                className="w-full px-4 py-2 bg-gray-50 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                style={{ color: '#10122F' }}
                autoFocus
              />
              <div className="flex gap-2 flex-wrap">
                <button
                  onClick={() => setEditDateType('inbox')}
                  className={`px-3 py-1.5 rounded-lg text-sm transition-all ${
                    editDateType === 'inbox'
                      ? 'text-white shadow-md'
                      : 'bg-gray-100 hover:bg-gray-200'
                  }`}
                  style={{
                    backgroundColor: editDateType === 'inbox' ? '#5176FB' : undefined,
                    color: editDateType === 'inbox' ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ“¥ Inbox
                </button>
                <button
                  onClick={() => setEditDateType('today')}
                  className={`px-3 py-1.5 rounded-lg text-sm transition-all ${
                    editDateType === 'today'
                      ? 'text-white shadow-md'
                      : 'bg-gray-100 hover:bg-gray-200'
                  }`}
                  style={{
                    backgroundColor: editDateType === 'today' ? '#5176FB' : undefined,
                    color: editDateType === 'today' ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ“… Dnes
                </button>
                <button
                  onClick={() => setEditDateType('week')}
                  className={`px-3 py-1.5 rounded-lg text-sm transition-all ${
                    editDateType === 'week'
                      ? 'text-white shadow-md'
                      : 'bg-gray-100 hover:bg-gray-200'
                  }`}
                  style={{
                    backgroundColor: editDateType === 'week' ? '#5176FB' : undefined,
                    color: editDateType === 'week' ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ“† TÃ½Å¾deÅˆ
                </button>
                <button
                  onClick={() => setEditDateType('someday')}
                  className={`px-3 py-1.5 rounded-lg text-sm transition-all ${
                    editDateType === 'someday'
                      ? 'text-white shadow-md'
                      : 'bg-gray-100 hover:bg-gray-200'
                  }`}
                  style={{
                    backgroundColor: editDateType === 'someday' ? '#5176FB' : undefined,
                    color: editDateType === 'someday' ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  â˜ï¸ Niekedy
                </button>
                <button
                  onClick={() => setEditDateType('specific')}
                  className={`px-3 py-1.5 rounded-lg text-sm transition-all ${
                    editDateType === 'specific'
                      ? 'text-white shadow-md'
                      : 'bg-gray-100 hover:bg-gray-200'
                  }`}
                  style={{
                    backgroundColor: editDateType === 'specific' ? '#5176FB' : undefined,
                    color: editDateType === 'specific' ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ—“ï¸ DÃ¡tum
                </button>
              </div>
              <div className="flex gap-2 flex-wrap">
                {editDateType === 'specific' && (
                  <input
                    type="date"
                    value={editDate}
                    onChange={(e) => setEditDate(e.target.value)}
                    className="flex-1 min-w-[150px] px-3 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"
                    style={{ color: '#10122F' }}
                  />
                )}
                <select
                  value={editPriority}
                  onChange={(e) => setEditPriority(e.target.value)}
                  className="px-4 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"
                  style={{ color: '#10122F' }}
                >
                  <option value="urgent">ğŸ”¥ Urgent</option>
                  <option value="less-urgent">âš¡ Less urgent</option>
                  <option value="can-wait">âœ¨ Can wait</option>
                </select>
                <select
                  value={editStatus}
                  onChange={(e) => setEditStatus(e.target.value)}
                  className="px-4 py-2 bg-gray-50 border-2 border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"
                  style={{ color: '#10122F' }}
                >
                  <option value="none">â€”</option>
                  <option value="working">ğŸ”¨ Working on it</option>
                  <option value="waiting">â³ Waiting</option>
                  <option value="stuck">ğŸš§ Stuck</option>
                </select>
              </div>
              <div className="flex gap-2">
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    saveFullEdit();
                  }}
                  className="px-4 py-2 text-white rounded-lg hover:shadow-lg transition-all flex items-center gap-2"
                  style={{ backgroundColor: '#4d7cff' }}
                >
                  ğŸ’¾ UloÅ¾iÅ¥
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    cancelEdit();
                  }}
                  className="px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-all flex items-center gap-2"
                  style={{ color: '#7C799A' }}
                >
                  âœ• ZruÅ¡iÅ¥
                </button>
              </div>
            </div>
          ) : editingId === todo.id ? (
            <div className="flex-1">
              <input
                type="text"
                value={editTask}
                onChange={(e) => setEditTask(e.target.value)}
                onBlur={() => {
                  setIsTyping(false);
                  saveTaskName(todo.id, editTask);
                }}
                onKeyPress={(e) => {
                  if (e.key === 'Enter') {
                    setIsTyping(false);
                    saveTaskName(todo.id, editTask);
                  }
                }}
                className="w-full px-4 py-2 bg-gray-50 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400"
                style={{ color: '#10122F' }}
                autoFocus
              />
            </div>
          ) : (
            <>
              <div 
                className="flex-1 min-w-0"
                onClick={() => !todo.completed && startEdit(todo)}
              >
                <p className={`font-medium text-lg ${todo.completed ? 'line-through' : ''}`}
                   style={{ color: todo.completed ? '#7C799A' : '#10122F' }}>
                  {todo.task}
                </p>
                <div className="flex gap-3 mt-2 flex-wrap items-center relative">
                  <div className="flex gap-1">
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        quickChangeDate(todo.id, 'today');
                      }}
                      className={`px-2 py-1 rounded text-xs transition-all ${
                        todo.dateType === 'today' || isToday(todo.date)
                          ? 'text-white shadow-md'
                          : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: (todo.dateType === 'today' || isToday(todo.date)) ? '#5176FB' : undefined,
                        color: (todo.dateType === 'today' || isToday(todo.date)) ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      ğŸ“… Dnes
                    </button>
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        quickChangeDate(todo.id, 'week');
                      }}
                      className={`px-2 py-1 rounded text-xs transition-all ${
                        todo.dateType === 'week'
                          ? 'text-white shadow-md'
                          : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: todo.dateType === 'week' ? '#5176FB' : undefined,
                        color: todo.dateType === 'week' ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      ğŸ“† TÃ½Å¾deÅˆ
                    </button>
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        quickChangeDate(todo.id, 'someday');
                      }}
                      className={`px-2 py-1 rounded text-xs transition-all ${
                        todo.dateType === 'someday'
                          ? 'text-white shadow-md'
                          : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: todo.dateType === 'someday' ? '#5176FB' : undefined,
                        color: todo.dateType === 'someday' ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      â˜ï¸ Niekedy
                    </button>
                  </div>
                  
                  {todo.dateType === 'specific' && todo.date && (
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        setShowDatePicker(showDatePicker === todo.id ? null : todo.id);
                      }}
                      className="text-xs px-2 py-1 rounded flex items-center gap-1 hover:shadow-md transition-all"
                      style={{
                        backgroundColor: '#e9eeff',
                        color: '#5176FB'
                      }}
                    >
                      ğŸ“… {formatDate(todo.date, todo.dateLabel)}
                    </button>
                  )}
                  
                  {showDatePicker === todo.id && (
                    <div className="absolute z-50 mt-8 p-4 rounded-2xl shadow-2xl border-2 backdrop-blur-lg" 
                         style={{ 
                           backgroundColor: 'rgba(255, 255, 255, 0.98)',
                           borderColor: '#5176FB',
                           minWidth: '280px'
                         }}
                         onClick={(e) => e.stopPropagation()}>
                      <div className="mb-3">
                        <label className="block text-sm font-medium mb-2" style={{ color: '#10122F' }}>
                          Vyber dÃ¡tum:
                        </label>
                        <input
                          type="date"
                          defaultValue={todo.date}
                          onChange={(e) => {
                            if (e.target.value) {
                              quickChangeDateSpecific(todo.id, e.target.value);
                            }
                          }}
                          className="w-full px-4 py-3 border-2 rounded-xl focus:outline-none focus:ring-4 transition-all text-lg"
                          style={{ 
                            backgroundColor: '#f9fcfe',
                            borderColor: '#5176FB',
                            color: '#10122F'
                          }}
                        />
                      </div>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          setShowDatePicker(null);
                        }}
                        className="w-full px-4 py-2 rounded-lg transition-all font-medium"
                        style={{
                          backgroundColor: '#5176FB',
                          color: '#FFFFFF'
                        }}
                      >
                        ZavrieÅ¥
                      </button>
                    </div>
                  )}
                  
                  {todo.status && todo.status !== 'none' && (
                    <span className="text-xs px-2 py-1 rounded flex items-center gap-1" style={{
                      backgroundColor: todo.status === 'working' ? '#e9eeff' : todo.status === 'waiting' ? '#FFF5E6' : '#FFE9E9',
                      color: todo.status === 'working' ? '#5176FB' : todo.status === 'waiting' ? '#da7aff' : '#F16475'
                    }}>
                      {todo.status === 'working' ? 'ğŸ”¨ Working on it' : todo.status === 'waiting' ? 'â³ Waiting' : 'ğŸš§ Stuck'}
                    </span>
                  )}
                  {todo.completed && todo.completedAt && (
                    <span className="text-xs px-2 py-1 rounded bg-green-100 text-green-700 flex items-center gap-1">
                      âœ“ DokonÄenÃ© {new Date(todo.completedAt).toLocaleDateString('sk-SK', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' })}
                    </span>
                  )}
                  {!todo.completed && (
                    <div className="flex gap-1">
                      {['urgent', 'less-urgent', 'can-wait'].map(p => (
                        <button
                          key={p}
                          onClick={(e) => {
                            e.stopPropagation();
                            changePriority(todo.id, p);
                          }}
                          className={`px-3 py-1 rounded-lg text-xs font-medium transition-all duration-300 ${
                            todo.priority === p
                              ? 'text-white shadow-md scale-110'
                              : 'bg-gray-100 hover:bg-gray-200'
                          }`}
                          style={{
                            backgroundColor: todo.priority === p ? (p === 'urgent' || p === 'high' ? '#F16475' : p === 'less-urgent' || p === 'medium' ? '#da7aff' : '#4d7cff') : undefined,
                            color: todo.priority === p ? '#FFFFFF' : '#7C799A'
                          }}
                        >
                          {p === 'urgent' || p === 'high' ? 'ğŸ”¥' : p === 'less-urgent' || p === 'medium' ? 'âš¡' : 'âœ¨'}
                        </button>
                      ))}
                    </div>
                  )}
                  {!todo.completed && (
                    <div className="flex gap-1">
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          changeStatus(todo.id, todo.status === 'working' ? 'none' : 'working');
                        }}
                        className={`px-2 py-1 rounded text-xs transition-all ${
                          todo.status === 'working' ? 'shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                        }`}
                        style={{
                          backgroundColor: todo.status === 'working' ? '#5176FB' : undefined,
                          color: todo.status === 'working' ? '#FFFFFF' : '#7C799A'
                        }}
                      >
                        ğŸ”¨
                      </button>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          changeStatus(todo.id, todo.status === 'waiting' ? 'none' : 'waiting');
                        }}
                        className={`px-2 py-1 rounded text-xs transition-all ${
                          todo.status === 'waiting' ? 'shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                        }`}
                        style={{
                          backgroundColor: todo.status === 'waiting' ? '#da7aff' : undefined,
                          color: todo.status === 'waiting' ? '#FFFFFF' : '#7C799A'
                        }}
                      >
                        â³
                      </button>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          changeStatus(todo.id, todo.status === 'stuck' ? 'none' : 'stuck');
                        }}
                        className={`px-2 py-1 rounded text-xs transition-all ${
                          todo.status === 'stuck' ? 'shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                        }`}
                        style={{
                          backgroundColor: todo.status === 'stuck' ? '#F16475' : undefined,
                          color: todo.status === 'stuck' ? '#FFFFFF' : '#7C799A'
                        }}
                      >
                        ğŸš§
                      </button>
                    </div>
                  )}
                </div>
              </div>
              
              <div className="flex gap-2">
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    startFullEdit(todo);
                  }}
                  className="text-gray-400 hover:text-blue-500 transition-all duration-300 hover:scale-125"
                >
                  âœï¸
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    deleteTodo(todo.id);
                  }}
                  className="text-gray-400 hover:text-red-400 transition-all duration-300 hover:scale-125"
                >
                  ğŸ—‘ï¸
                </button>
              </div>
            </>
          )}
        </div>
      );

      return (
        <div className="min-h-screen p-4" style={{ background: 'linear-gradient(135deg, #EAEEFC 0%, #f9fcfe 100%)' }}>
          <div className="max-w-5xl mx-auto">
            <div className="bg-white rounded-3xl shadow-lg p-8 mb-6 border" style={{ borderColor: '#f0f3fc' }}>
              <h1 className="text-4xl font-bold mb-8 tracking-tight flex items-center gap-3" style={{ color: '#10122F' }}>
                âœ¨ Moje Ãºlohy
                {isSaving && (
                  <span className="text-2xl animate-pulse">
                    ğŸ’¾
                  </span>
                )}
              </h1>

              {showStats && (
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                  <div className="rounded-xl p-4 border-2" style={{ backgroundColor: '#EAEEFC', borderColor: '#F16475' }}>
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-xl">ğŸ†</span>
                      <span className="text-sm font-medium" style={{ color: '#7C799A' }}>Dnes</span>
                    </div>
                    <p className="text-3xl font-bold" style={{ color: '#10122F' }}>{stats.today}</p>
                  </div>
                  
                  <div className="rounded-xl p-4 border-2" style={{ backgroundColor: '#EAEEFC', borderColor: '#5176FB' }}>
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-xl">ğŸ“ˆ</span>
                      <span className="text-sm font-medium" style={{ color: '#7C799A' }}>Tento tÃ½Å¾deÅˆ</span>
                    </div>
                    <p className="text-3xl font-bold" style={{ color: '#10122F' }}>{stats.week}</p>
                  </div>
                  
                  <div className="rounded-xl p-4 border-2" style={{ backgroundColor: '#EAEEFC', borderColor: '#da7aff' }}>
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-xl">ğŸ“…</span>
                      <span className="text-sm font-medium" style={{ color: '#7C799A' }}>Tento mesiac</span>
                    </div>
                    <p className="text-3xl font-bold" style={{ color: '#10122F' }}>{stats.month}</p>
                  </div>
                  
                  <div className="rounded-xl p-4 border-2" style={{ backgroundColor: '#EAEEFC', borderColor: '#4d7cff' }}>
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-xl">âœ“</span>
                      <span className="text-sm font-medium" style={{ color: '#7C799A' }}>Celkovo</span>
                    </div>
                    <p className="text-3xl font-bold" style={{ color: '#10122F' }}>{stats.total}</p>
                  </div>
                </div>
              )}

              {showStats && (
                <div className="mb-8">
                  <button
                    onClick={() => setShowExpandedStats(!showExpandedStats)}
                    className="w-full flex items-center justify-between px-6 py-3 rounded-xl transition-all duration-300 hover:bg-gray-50"
                    style={{ border: '2px solid #f0f3fc' }}
                  >
                    <span className="font-medium" style={{ color: '#10122F' }}>
                      ğŸ“Š RozÅ¡Ã­renÃ© Å¡tatistiky
                    </span>
                    <span className="text-2xl" style={{ color: '#7C799A' }}>
                      {showExpandedStats ? 'âˆ’' : '+'}
                    </span>
                  </button>

                  {showExpandedStats && (
                    <div className="mt-4 p-6 rounded-xl" style={{ backgroundColor: '#f9fcfe', border: '2px solid #f0f3fc' }}>
                      {/* Key Metrics Grid */}
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#5176FB' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>â° NajproduktÃ­vnejÅ¡ia hodina</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.mostProductiveHour}</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#5176FB' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ“† NajproduktÃ­vnejÅ¡Ã­ deÅˆ</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.mostProductiveDay}</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#5176FB' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸŒ… ÄŒasovÃ½ typ</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.timePreference}</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#F16475' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ”¥ AktuÃ¡lny streak</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.currentStreak} dnÃ­</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#F16475' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ… NajdlhÅ¡Ã­ streak</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.longestStreak} dnÃ­</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#da7aff' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ¯ Personal best</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.personalBest} Ãºloh/deÅˆ</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#4d7cff' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ“Š Priemer (30 dnÃ­)</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>{advancedStats.avgPerDay} Ãºloh/deÅˆ</div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: advancedStats.trendDirection === 'up' ? '#4ade80' : advancedStats.trendDirection === 'down' ? '#F16475' : '#7C799A' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ“ˆ Trend</div>
                          <div className="text-xl font-bold" style={{ color: '#10122F' }}>
                            {advancedStats.trendDirection === 'up' ? 'â†—' : advancedStats.trendDirection === 'down' ? 'â†˜' : 'â†’'} {advancedStats.trend}%
                          </div>
                          <div className="text-xs mt-1" style={{ color: '#7C799A' }}>
                            Tento tÃ½Å¾deÅˆ: {advancedStats.thisWeekCount} vs MinulÃ½: {advancedStats.prevWeekCount}
                          </div>
                        </div>
                        
                        <div className="p-4 rounded-xl bg-white border-2" style={{ borderColor: '#da7aff' }}>
                          <div className="text-sm font-medium mb-1" style={{ color: '#7C799A' }}>ğŸ‰ NajlepÅ¡Ã­ mesiac</div>
                          <div className="text-lg font-bold" style={{ color: '#10122F' }}>{advancedStats.mostProductiveMonth}</div>
                        </div>
                      </div>

                      {/* Priority Distribution */}
                      <div className="mb-6 p-4 rounded-xl bg-white">
                        <h3 className="text-lg font-bold mb-4" style={{ color: '#10122F' }}>ğŸ“Œ Rozdelenie podÄ¾a priority</h3>
                        <div className="space-y-3">
                          <div>
                            <div className="flex items-center justify-between mb-1">
                              <span className="text-sm font-medium" style={{ color: '#7C799A' }}>ğŸ”¥ Urgent</span>
                              <span className="text-sm font-bold" style={{ color: '#10122F' }}>{advancedStats.priorityCounts.urgent || 0} Ãºloh</span>
                            </div>
                            <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
                              <div 
                                className="h-full rounded-full transition-all" 
                                style={{ 
                                  width: `${advancedStats.totalCompleted > 0 ? (advancedStats.priorityCounts.urgent || 0) / advancedStats.totalCompleted * 100 : 0}%`,
                                  backgroundColor: '#F16475'
                                }}
                              />
                            </div>
                            {advancedStats.avgTimes.urgent && (
                              <div className="text-xs mt-1" style={{ color: '#7C799A' }}>
                                PriemernÃ½ Äas na dokonÄenie: {advancedStats.avgTimes.urgent} dnÃ­
                              </div>
                            )}
                          </div>
                          
                          <div>
                            <div className="flex items-center justify-between mb-1">
                              <span className="text-sm font-medium" style={{ color: '#7C799A' }}>âš¡ Less urgent</span>
                              <span className="text-sm font-bold" style={{ color: '#10122F' }}>{advancedStats.priorityCounts['less-urgent'] || 0} Ãºloh</span>
                            </div>
                            <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
                              <div 
                                className="h-full rounded-full transition-all" 
                                style={{ 
                                  width: `${advancedStats.totalCompleted > 0 ? (advancedStats.priorityCounts['less-urgent'] || 0) / advancedStats.totalCompleted * 100 : 0}%`,
                                  backgroundColor: '#da7aff'
                                }}
                              />
                            </div>
                            {advancedStats.avgTimes['less-urgent'] && (
                              <div className="text-xs mt-1" style={{ color: '#7C799A' }}>
                                PriemernÃ½ Äas na dokonÄenie: {advancedStats.avgTimes['less-urgent']} dnÃ­
                              </div>
                            )}
                          </div>
                          
                          <div>
                            <div className="flex items-center justify-between mb-1">
                              <span className="text-sm font-medium" style={{ color: '#7C799A' }}>âœ¨ Can wait</span>
                              <span className="text-sm font-bold" style={{ color: '#10122F' }}>{advancedStats.priorityCounts['can-wait'] || 0} Ãºloh</span>
                            </div>
                            <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
                              <div 
                                className="h-full rounded-full transition-all" 
                                style={{ 
                                  width: `${advancedStats.totalCompleted > 0 ? (advancedStats.priorityCounts['can-wait'] || 0) / advancedStats.totalCompleted * 100 : 0}%`,
                                  backgroundColor: '#4d7cff'
                                }}
                              />
                            </div>
                            {advancedStats.avgTimes['can-wait'] && (
                              <div className="text-xs mt-1" style={{ color: '#7C799A' }}>
                                PriemernÃ½ Äas na dokonÄenie: {advancedStats.avgTimes['can-wait']} dnÃ­
                              </div>
                            )}
                          </div>
                        </div>
                      </div>

                      {/* 30-Day Bar Chart */}
                      <div className="p-4 rounded-xl bg-white">
                        <h3 className="text-lg font-bold mb-4" style={{ color: '#10122F' }}>ğŸ“Š PoslednÃ½ch 30 dnÃ­</h3>
                        <div className="flex items-end justify-between gap-1 h-40">
                          {advancedStats.last30Days.map((day, index) => {
                            const maxCount = Math.max(...advancedStats.last30Days.map(d => d.count), 1);
                            const height = (day.count / maxCount) * 100;
                            const isToday = day.date === new Date().toISOString().split('T')[0];
                            
                            return (
                              <div key={index} className="flex-1 flex flex-col items-center">
                                <div 
                                  className="w-full rounded-t transition-all hover:opacity-80"
                                  style={{ 
                                    height: `${height}%`,
                                    backgroundColor: isToday ? '#F16475' : day.count > 0 ? '#5176FB' : '#e5e7eb',
                                    minHeight: day.count > 0 ? '4px' : '2px'
                                  }}
                                  title={`${new Date(day.date).toLocaleDateString('sk-SK', { day: 'numeric', month: 'short' })}: ${day.count} Ãºloh`}
                                />
                              </div>
                            );
                          })}
                        </div>
                        <div className="flex justify-between mt-2 text-xs" style={{ color: '#7C799A' }}>
                          <span>30 dnÃ­ dozadu</span>
                          <span>Dnes</span>
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              )}
              
              <div className="flex gap-3 mb-8 flex-wrap">
                <button
                  onClick={() => setShowStats(!showStats)}
                  className={`flex items-center gap-2 px-6 py-3 rounded-xl transition-all duration-300 font-medium ${
                    showStats ? 'text-white shadow-lg scale-105' : 'hover:bg-gray-100'
                  }`}
                  style={{
                    backgroundColor: showStats ? '#4d7cff' : 'transparent',
                    color: showStats ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ“Š Å tatistiky
                </button>
                <button
                  onClick={() => setShowCalendar(!showCalendar)}
                  className={`flex items-center gap-2 px-6 py-3 rounded-xl transition-all duration-300 font-medium ${
                    showCalendar ? 'text-white shadow-lg scale-105' : 'hover:bg-gray-100'
                  }`}
                  style={{
                    backgroundColor: showCalendar ? '#5176FB' : 'transparent',
                    color: showCalendar ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ“… KalendÃ¡r
                </button>
                <button
                  onClick={() => setShowPizzaReview(!showPizzaReview)}
                  className={`flex items-center gap-2 px-6 py-3 rounded-xl transition-all duration-300 font-medium ${
                    showPizzaReview ? 'text-white shadow-lg scale-105' : 'hover:bg-gray-100'
                  }`}
                  style={{
                    backgroundColor: showPizzaReview ? '#F16475' : 'transparent',
                    color: showPizzaReview ? '#FFFFFF' : '#7C799A'
                  }}
                >
                  ğŸ• Pizza Review
                </button>
              </div>

              {showCalendar && (
                <div className="mb-8 p-6 rounded-2xl border-2" style={{ backgroundColor: '#f9fcfe', borderColor: '#5176FB' }}>
                  <div className="flex items-center justify-between mb-6">
                    <button
                      onClick={(e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        previousMonth();
                      }}
                      className="px-4 py-2 rounded-lg hover:bg-white transition-all"
                      style={{ color: '#5176FB' }}
                    >
                      â† PredoÅ¡lÃ½
                    </button>
                    <h3 className="text-2xl font-bold" style={{ color: '#10122F' }}>
                      {currentMonth.toLocaleDateString('sk-SK', { month: 'long', year: 'numeric' })}
                    </h3>
                    <button
                      onClick={(e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        nextMonth();
                      }}
                      className="px-4 py-2 rounded-lg hover:bg-white transition-all"
                      style={{ color: '#5176FB' }}
                    >
                      ÄalÅ¡Ã­ â†’
                    </button>
                  </div>
                  
                  <div className="grid grid-cols-7 gap-2">
                    {['Po', 'Ut', 'St', 'Å t', 'Pi', 'So', 'Ne'].map(day => (
                      <div key={day} className="text-center font-bold py-2" style={{ color: '#7C799A' }}>
                        {day}
                      </div>
                    ))}
                    
                    {(() => {
                      const { daysInMonth, startingDayOfWeek, year, month } = getDaysInMonth(currentMonth);
                      const days = [];
                      const adjustedStart = startingDayOfWeek === 0 ? 6 : startingDayOfWeek - 1;
                      
                      for (let i = 0; i < adjustedStart; i++) {
                        days.push(<div key={`empty-${i}`} className="aspect-square"></div>);
                      }
                      
                      for (let day = 1; day <= daysInMonth; day++) {
                        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                        const tasksForDay = getTasksForDate(dateStr);
                        const isTodayDate = dateStr === new Date().toISOString().split('T')[0];
                        const isSelected = selectedDate === dateStr;
                        
                        days.push(
                          <div
                            key={day}
                            onClick={() => setSelectedDate(isSelected ? null : dateStr)}
                            className="aspect-square p-2 rounded-xl cursor-pointer transition-all hover:scale-105"
                            style={{
                              backgroundColor: isSelected ? '#5176FB' : isTodayDate ? '#e9eeff' : 'white',
                              border: `2px solid ${isTodayDate ? '#5176FB' : 'transparent'}`,
                              color: isSelected ? '#FFFFFF' : '#10122F'
                            }}
                          >
                            <div className="font-semibold mb-1">{day}</div>
                            {tasksForDay.length > 0 && (
                              <div className="flex flex-wrap gap-1">
                                {tasksForDay.slice(0, 3).map(task => (
                                  <div
                                    key={task.id}
                                    className="w-2 h-2 rounded-full"
                                    style={{
                                      backgroundColor: task.completed ? '#4ade80' : task.priority === 'urgent' ? '#F16475' : task.priority === 'less-urgent' ? '#da7aff' : '#4d7cff'
                                    }}
                                  ></div>
                                ))}
                                {tasksForDay.length > 3 && (
                                  <div className="text-xs" style={{ color: isSelected ? '#FFFFFF' : '#7C799A' }}>
                                    +{tasksForDay.length - 3}
                                  </div>
                                )}
                              </div>
                            )}
                          </div>
                        );
                      }
                      
                      return days;
                    })()}
                  </div>
                  
                  {selectedDate && (
                    <div className="mt-6 p-4 rounded-xl" style={{ backgroundColor: 'white', border: '2px solid #5176FB' }}>
                      <div className="flex items-center justify-between mb-4">
                        <h4 className="text-lg font-bold" style={{ color: '#10122F' }}>
                          ğŸ“… {new Date(selectedDate).toLocaleDateString('sk-SK', { day: 'numeric', month: 'long', year: 'numeric' })}
                        </h4>
                        <button
                          onClick={() => setSelectedDate(null)}
                          className="text-gray-400 hover:text-gray-600"
                        >
                          âœ•
                        </button>
                      </div>
                      
                      {getTasksForDate(selectedDate).length === 0 ? (
                        <p className="text-center py-4" style={{ color: '#7C799A' }}>
                          Å½iadne Ãºlohy v tento deÅˆ
                        </p>
                      ) : (
                        <div className="space-y-2">
                          {getTasksForDate(selectedDate).map(task => (
                            <div
                              key={task.id}
                              className="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 transition-all"
                            >
                              <button
                                onClick={() => toggleComplete(task.id)}
                                className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center flex-shrink-0 ${
                                  task.completed ? 'bg-green-500 border-green-500' : 'border-gray-300'
                                }`}
                              >
                                {task.completed && <span className="text-white text-sm">âœ“</span>}
                              </button>
                              <span
                                className={`flex-1 ${task.completed ? 'line-through opacity-50' : ''}`}
                                style={{ color: '#10122F' }}
                              >
                                {task.task}
                              </span>
                              <div className="flex gap-1">
                                <button
                                  onClick={() => startFullEdit(task)}
                                  className="text-gray-400 hover:text-blue-500 transition-all"
                                >
                                  âœï¸
                                </button>
                                <button
                                  onClick={() => deleteTodo(task.id)}
                                  className="text-gray-400 hover:text-red-400 transition-all"
                                >
                                  ğŸ—‘ï¸
                                </button>
                              </div>
                            </div>
                          ))}
                        </div>
                      )}
                    </div>
                  )}
                </div>
              )}

              {showPizzaReview && (
                <div className="mb-8 p-6 rounded-2xl border-2" style={{ backgroundColor: '#FFF5F5', borderColor: '#F16475' }}>
                  <div className="flex items-center justify-between mb-6">
                    <div className="flex items-center gap-3">
                      <span className="text-3xl">ğŸ•</span>
                      <h3 className="text-2xl font-bold" style={{ color: '#10122F' }}>
                        Pizza Review
                      </h3>
                    </div>
                  </div>

                  <div className="mb-6 p-4 rounded-xl bg-white border-2" style={{ borderColor: '#F16475' }}>
                    <div className="flex items-center justify-between mb-4">
                      <label className="text-sm font-medium" style={{ color: '#10122F' }}>
                        PoslednÃ½ Pizza Review:
                      </label>
                      {!editingPizzaDate && pizzaReviewDate && (
                        <button
                          onClick={() => setEditingPizzaDate(true)}
                          className="text-xs px-3 py-1 rounded-lg hover:bg-gray-100 transition-all"
                          style={{ color: '#F16475' }}
                        >
                          âœï¸ ZmeniÅ¥
                        </button>
                      )}
                    </div>
                    
                    {editingPizzaDate || !pizzaReviewDate ? (
                      <div className="flex gap-2">
                        <input
                          type="date"
                          defaultValue={pizzaReviewDate || new Date().toISOString().split('T')[0]}
                          onChange={(e) => {
                            if (e.target.value) {
                              setPizzaReviewDate(e.target.value);
                              setEditingPizzaDate(false);
                            }
                          }}
                          className="flex-1 px-4 py-2 border-2 rounded-xl focus:outline-none focus:ring-2 transition-all"
                          style={{ 
                            backgroundColor: '#f9fcfe',
                            borderColor: '#F16475',
                            color: '#10122F'
                          }}
                        />
                        {pizzaReviewDate && (
                          <button
                            onClick={() => setEditingPizzaDate(false)}
                            className="px-4 py-2 rounded-xl transition-all"
                            style={{
                              backgroundColor: '#F16475',
                              color: '#FFFFFF'
                            }}
                          >
                            ZavrieÅ¥
                          </button>
                        )}
                      </div>
                    ) : (
                      <p className="text-xl font-bold" style={{ color: '#F16475' }}>
                        {new Date(pizzaReviewDate).toLocaleDateString('sk-SK', { day: 'numeric', month: 'long', year: 'numeric' })}
                      </p>
                    )}
                  </div>

                  {pizzaReviewDate && (
                    <div>
                      <h4 className="text-lg font-bold mb-4" style={{ color: '#10122F' }}>
                        DokonÄenÃ© Ãºlohy od poslednÃ©ho Pizza Review:
                      </h4>
                      {(() => {
                        const reviewDate = new Date(pizzaReviewDate);
                        reviewDate.setHours(0, 0, 0, 0);
                        const completedSinceReview = todos.filter(t => {
                          if (!t.completed || !t.completedAt) return false;
                          const completedDate = new Date(t.completedAt);
                          return completedDate >= reviewDate;
                        }).sort((a, b) => new Date(b.completedAt) - new Date(a.completedAt));

                        if (completedSinceReview.length === 0) {
                          return (
                            <p className="text-center py-8" style={{ color: '#7C799A' }}>
                              ZatiaÄ¾ Å¾iadne dokonÄenÃ© Ãºlohy od poslednÃ©ho Pizza Review
                            </p>
                          );
                        }

                        return (
                          <div className="space-y-2">
                            {completedSinceReview.map(task => (
                              <div
                                key={task.id}
                                className="flex items-center gap-3 p-4 rounded-xl bg-white border hover:shadow-md transition-all"
                                style={{ borderColor: '#F16475' }}
                              >
                                <div className="w-6 h-6 rounded-lg bg-green-500 flex items-center justify-center flex-shrink-0">
                                  <span className="text-white text-sm">âœ“</span>
                                </div>
                                <div className="flex-1">
                                  <p className="font-medium" style={{ color: '#10122F' }}>
                                    {task.task}
                                  </p>
                                  <p className="text-xs mt-1" style={{ color: '#7C799A' }}>
                                    DokonÄenÃ©: {new Date(task.completedAt).toLocaleDateString('sk-SK', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' })}
                                  </p>
                                </div>
                                {task.priority && (
                                  <span className="text-xs px-2 py-1 rounded" style={{
                                    backgroundColor: task.priority === 'urgent' ? '#FFE9E9' : task.priority === 'less-urgent' ? '#FFF5E6' : '#e9eeff',
                                    color: task.priority === 'urgent' ? '#F16475' : task.priority === 'less-urgent' ? '#da7aff' : '#5176FB'
                                  }}>
                                    {task.priority === 'urgent' ? 'ğŸ”¥' : task.priority === 'less-urgent' ? 'âš¡' : 'âœ¨'}
                                  </span>
                                )}
                              </div>
                            ))}
                            <div className="mt-6 p-4 rounded-xl text-center" style={{ backgroundColor: '#e9eeff' }}>
                              <p className="text-2xl font-bold mb-1" style={{ color: '#5176FB' }}>
                                {completedSinceReview.length}
                              </p>
                              <p className="text-sm" style={{ color: '#7C799A' }}>
                                Ãºloh dokonÄenÃ½ch od {new Date(pizzaReviewDate).toLocaleDateString('sk-SK', { day: 'numeric', month: 'short' })}
                              </p>
                            </div>
                          </div>
                        );
                      })()}
                    </div>
                  )}
                </div>
              )}

              <div className="space-y-4">
                <input
                  type="text"
                  value={newTask}
                  onChange={(e) => setNewTask(e.target.value)}
                  onKeyPress={(e) => e.key === 'Enter' && addTodo()}
                  placeholder="NovÃ¡ Ãºloha..."
                  className="w-full px-6 py-4 border-2 rounded-2xl focus:outline-none focus:ring-4 transition-all"
                  style={{ 
                    backgroundColor: '#f9fcfe',
                    borderColor: '#f0f3fc',
                    color: '#10122F'
                  }}
                />
                <div className="flex gap-3 flex-wrap">
                  <div className="flex gap-2 flex-wrap flex-1 min-w-[300px]">
                    <button
                      onClick={() => setNewDateType('today')}
                      className={`px-4 py-2 rounded-lg transition-all ${
                        newDateType === 'today' ? 'text-white shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: newDateType === 'today' ? '#5176FB' : undefined,
                        color: newDateType === 'today' ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      ğŸ“… Dnes
                    </button>
                    <button
                      onClick={() => setNewDateType('week')}
                      className={`px-4 py-2 rounded-lg transition-all ${
                        newDateType === 'week' ? 'text-white shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: newDateType === 'week' ? '#5176FB' : undefined,
                        color: newDateType === 'week' ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      ğŸ“† Tento tÃ½Å¾deÅˆ
                    </button>
                    <button
                      onClick={() => setNewDateType('someday')}
                      className={`px-4 py-2 rounded-lg transition-all ${
                        newDateType === 'someday' ? 'text-white shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: newDateType === 'someday' ? '#5176FB' : undefined,
                        color: newDateType === 'someday' ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      â˜ï¸ Niekedy
                    </button>
                    <button
                      onClick={() => setNewDateType('specific')}
                      className={`px-4 py-2 rounded-lg transition-all ${
                        newDateType === 'specific' ? 'text-white shadow-md' : 'bg-gray-100 hover:bg-gray-200'
                      }`}
                      style={{
                        backgroundColor: newDateType === 'specific' ? '#5176FB' : undefined,
                        color: newDateType === 'specific' ? '#FFFFFF' : '#7C799A'
                      }}
                    >
                      ğŸ—“ï¸ KonkrÃ©tny dÃ¡tum
                    </button>
                  </div>
                  {newDateType === 'specific' && (
                    <input
                      type="date"
                      value={newDate}
                      onChange={(e) => setNewDate(e.target.value)}
                      className="px-4 py-2 border-2 rounded-xl focus:outline-none focus:ring-4 transition-all"
                      style={{ 
                        backgroundColor: '#f9fcfe',
                        borderColor: '#f0f3fc',
                        color: '#10122F'
                      }}
                    />
                  )}
                  <select
                    value={newPriority}
                    onChange={(e) => setNewPriority(e.target.value)}
                    className="px-6 py-2 border-2 rounded-xl focus:outline-none focus:ring-4 transition-all"
                    style={{ 
                      backgroundColor: '#f9fcfe',
                      borderColor: '#f0f3fc',
                      color: '#10122F'
                    }}
                  >
                    <option value="urgent">ğŸ”¥ Urgent</option>
                    <option value="less-urgent">âš¡ Less urgent</option>
                    <option value="can-wait">âœ¨ Can wait</option>
                  </select>
                  <select
                    value={newStatus}
                    onChange={(e) => setNewStatus(e.target.value)}
                    className="px-6 py-2 border-2 rounded-xl focus:outline-none focus:ring-4 transition-all"
                    style={{ 
                      backgroundColor: '#f9fcfe',
                      borderColor: '#f0f3fc',
                      color: '#10122F'
                    }}
                  >
                    <option value="none">â€”</option>
                    <option value="working">ğŸ”¨ Working on it</option>
                    <option value="waiting">â³ Waiting</option>
                    <option value="stuck">ğŸš§ Stuck</option>
                  </select>
                  <button
                    onClick={addTodo}
                    className="px-8 py-2 text-white rounded-xl hover:shadow-xl transition-all duration-300 flex items-center gap-2 font-medium"
                    style={{ backgroundColor: '#4d7cff' }}
                  >
                    â• PridaÅ¥
                  </button>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-3xl shadow-lg p-8 border" style={{ borderColor: '#f0f3fc' }}>
              {todos.length === 0 ? (
                <div className="text-center py-20" style={{ color: '#7C799A' }}>
                  <span className="text-6xl mb-4 block">â°</span>
                  <p className="text-xl font-medium">ZatiaÄ¾ Å¾iadne Ãºlohy</p>
                  <p className="text-sm mt-2">Pridaj svoju prvÃº Ãºlohu a poÄ do toho! ğŸš€</p>
                </div>
              ) : (
                <div className="space-y-8">
                  {displayTodos.inbox.length > 0 && (
                    <div className="p-5 rounded-2xl" style={{ backgroundColor: '#F0F4FF' }}>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowInbox(!showInbox)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#5176FB' }}></div>
                          <h2 className="text-xl font-bold" style={{ color: '#10122F' }}>
                            ğŸ“¥ Inbox ({displayTodos.inbox.length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#10122F' }}>
                          {showInbox ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showInbox && (
                        <div className="space-y-3">
                          {displayTodos.inbox.map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}

                  {displayTodos.today.length > 0 && (
                    <div className="p-5 rounded-2xl" style={{ backgroundColor: '#FFF5F5' }}>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowToday(!showToday)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#F16475' }}></div>
                          <h2 className="text-xl font-bold" style={{ color: '#10122F' }}>
                            Dnes ({displayTodos.today.length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#10122F' }}>
                          {showToday ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showToday && (
                        <div className="space-y-3">
                          {displayTodos.today.map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}
                  
                  {displayTodos.thisWeek.length > 0 && (
                    <div>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowThisWeek(!showThisWeek)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#5176FB' }}></div>
                          <h2 className="text-xl font-bold" style={{ color: '#10122F' }}>
                            Tento tÃ½Å¾deÅˆ ({displayTodos.thisWeek.length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#10122F' }}>
                          {showThisWeek ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showThisWeek && (
                        <div className="space-y-3">
                          {displayTodos.thisWeek.map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}
                  
                  {displayTodos.nextWeek.length > 0 && (
                    <div>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowNextWeek(!showNextWeek)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#4d7cff' }}></div>
                          <h2 className="text-xl font-bold" style={{ color: '#10122F' }}>
                            ÄalÅ¡Ã­ tÃ½Å¾deÅˆ ({displayTodos.nextWeek.length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#10122F' }}>
                          {showNextWeek ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showNextWeek && (
                        <div className="space-y-3">
                          {displayTodos.nextWeek.map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}
                  
                  {displayTodos.later.length > 0 && (
                    <div>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowLater(!showLater)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#da7aff' }}></div>
                          <h2 className="text-xl font-bold" style={{ color: '#10122F' }}>
                            NeskÃ´r ({displayTodos.later.length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#10122F' }}>
                          {showLater ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showLater && (
                        <div className="space-y-3">
                          {displayTodos.later.map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}
                  
                  {displayTodos.someday.length > 0 && (
                    <div className="pt-6 border-t-2" style={{ borderColor: '#f0f3fc' }}>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowSomeday(!showSomeday)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#7C799A' }}></div>
                          <h2 className="text-xl font-bold" style={{ color: '#7C799A' }}>
                            Niekedy ({displayTodos.someday.length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#7C799A' }}>
                          {showSomeday ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showSomeday && (
                        <div className="space-y-3">
                          {displayTodos.someday.map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}

                  {todos.filter(t => t.completed).length > 0 && (
                    <div className="pt-6 border-t-2" style={{ borderColor: '#f0f3fc' }}>
                      <div 
                        className="flex items-center justify-between mb-4 cursor-pointer hover:opacity-80 transition-all"
                        onClick={() => setShowCompleted(!showCompleted)}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-2 h-2 rounded-full bg-green-500"></div>
                          <h2 className="text-xl font-bold" style={{ color: '#7C799A' }}>
                            DokonÄenÃ© ({todos.filter(t => t.completed).length})
                          </h2>
                        </div>
                        <button className="text-2xl" style={{ color: '#7C799A' }}>
                          {showCompleted ? 'âˆ’' : '+'}
                        </button>
                      </div>
                      {showCompleted && (
                        <div className="space-y-3">
                          {todos.filter(t => t.completed).map(todo => <TodoItem key={todo.id} todo={todo} />)}
                        </div>
                      )}
                    </div>
                  )}
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<TodoApp />, document.getElementById('root'));
  </script>
</body>
</html>
